<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Neobank ‚Äî –£–º–Ω—ã–π –º–æ–±–∏–ª—å–Ω—ã–π –±–∞–Ω–∫</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<meta name="theme-color" content="#6366f1">
<meta name="description" content="–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–æ–±–∏–ª—å–Ω—ã–π –±–∞–Ω–∫–∏–Ω–≥ —Å –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
    :root {
        --primary: #6366f1;
        --primary-dark: #4f46e5;
        --primary-light: #818cf8;
        --success: #10b981;
        --success-dark: #059669;
        --danger: #ef4444;
        --warning: #f59e0b;
        --info: #3b82f6;
        --dark: #0f172a;
        --dark-card: #1e293b;
        --gray: #64748b;
        --gray-light: #94a3b8;
        --light: #f1f5f9;
        --light-bg: #f8fafc;
        --card: #ffffff;
        --border: rgba(0,0,0,0.06);
        --shadow: 0 4px 16px rgba(0,0,0,0.06);
        --shadow-lg: 0 10px 30px rgba(0,0,0,0.1);
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --radius: 20px;
        --radius-sm: 14px;
    }
    
    [data-theme="dark"] {
        --primary: #818cf8;
        --primary-dark: #6366f1;
        --primary-light: #a5b4fc;
        --success: #34d399;
        --success-dark: #10b981;
        --danger: #f87171;
        --warning: #fbbf24;
        --info: #60a5fa;
        --dark: #f1f5f9;
        --dark-card: #334155;
        --gray: #94a3b8;
        --gray-light: #64748b;
        --light: #1e293b;
        --light-bg: #0f172a;
        --card: #1e293b;
        --border: rgba(255,255,255,0.08);
        --shadow: 0 4px 16px rgba(0,0,0,0.2);
        --shadow-lg: 0 10px 30px rgba(0,0,0,0.3);
    }
    
    * { 
        margin: 0; 
        padding: 0; 
        box-sizing: border-box; 
        -webkit-tap-highlight-color: transparent;
    }
    
    html {
        -webkit-text-size-adjust: 100%;
        scroll-behavior: smooth;
    }
    
    body {
        font-family: 'Inter', sans-serif;
        background: var(--light-bg);
        color: var(--dark);
        min-height: 100vh;
        font-size: 16px;
        line-height: 1.6;
        overflow-x: hidden;
        transition: background 0.3s, color 0.3s;
    }
    
    .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 16px;
        padding-bottom: 100px;
        position: relative;
        min-height: 100vh;
    }
    
    /* Pull-to-refresh */
    .refresh-indicator {
        position: fixed;
        top: -50px;
        left: 0;
        right: 0;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        color: var(--primary);
        font-size: 14px;
        font-weight: 500;
        background: var(--card);
        transition: transform 0.3s;
        box-shadow: var(--shadow);
    }
    
    .refresh-indicator.active {
        transform: translateY(50px);
    }
    
    .refresh-indicator i {
        margin-right: 10px;
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    /* Header */
    header {
        background: var(--card);
        border-radius: var(--radius);
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: var(--shadow);
        position: sticky;
        top: 8px;
        z-index: 50;
        transition: var(--transition);
        border: 1px solid var(--border);
    }
    
    header.scrolled {
        box-shadow: var(--shadow-lg);
    }
    
    header.hidden {
        transform: translateY(calc(-100% - 20px));
        pointer-events: none;
    }
    
    .header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .logo {
        font-size: 22px;
        font-weight: 800;
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--primary);
        cursor: pointer;
        transition: var(--transition);
        user-select: none;
    }
    
    .logo:active {
        transform: scale(0.95);
    }
    
    .logo i { 
        font-size: 26px; 
    }
    
    .header-actions {
        display: flex;
        gap: 10px;
        align-items: center;
    }
    
    .icon-btn {
        width: 42px;
        height: 42px;
        border-radius: 12px;
        background: var(--light);
        border: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--dark);
        font-size: 18px;
        cursor: pointer;
        transition: var(--transition);
        position: relative;
    }
    
    .icon-btn:active {
        transform: scale(0.9);
        background: var(--primary);
        color: white;
    }
    
    .notification-badge {
        position: absolute;
        top: -4px;
        right: -4px;
        min-width: 18px;
        height: 18px;
        background: var(--danger);
        color: white;
        border-radius: 9px;
        font-size: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        padding: 0 4px;
        border: 2px solid var(--card);
    }
    
    .balance-section {
        text-align: center;
        padding: 10px 0 5px;
        position: relative;
        cursor: pointer;
        user-select: none;
        -webkit-user-select: none;
    }
    
    .balance-label {
        font-size: 13px;
        color: var(--gray);
        margin-bottom: 8px;
        font-weight: 500;
        display: block;
        letter-spacing: 0.3px;
    }
    
    .balance-amount {
        font-size: 36px;
        font-weight: 800;
        color: var(--dark);
        line-height: 1.1;
        transition: var(--transition);
        letter-spacing: -1px;
    }
    
    .balance-hidden {
        filter: blur(12px);
    }
    
    /* –°–µ–∫—Ü–∏—è-–∫–∞—Ä—Ç–æ—á–∫–∞ */
    .section-card {
        background: var(--card);
        border-radius: var(--radius);
        padding: 22px;
        margin-bottom: 16px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
        transition: var(--transition);
    }
    
    .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 18px;
    }
    
    .section-title {
        font-size: 18px;
        font-weight: 700;
        color: var(--dark);
    }
    
    .section-action {
        padding: 8px 16px;
        font-size: 13px;
        font-weight: 600;
        color: var(--primary);
        background: rgba(99, 102, 241, 0.08);
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: var(--transition);
    }
    
    [data-theme="dark"] .section-action {
        background: rgba(129, 140, 248, 0.15);
    }
    
    .section-action:active {
        transform: scale(0.95);
        background: rgba(99, 102, 241, 0.15);
    }
    
    /* –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞ */
    .bank-card-container {
        perspective: 1000px;
        height: 210px;
        cursor: pointer;
        margin-bottom: 16px;
    }
    
    .bank-card {
        width: 100%;
        height: 100%;
        position: relative;
        transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        transform-style: preserve-3d;
    }
    
    .bank-card.flipped {
        transform: rotateY(180deg);
    }
    
    .card-front, .card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        border-radius: var(--radius);
        padding: 24px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        overflow: hidden;
    }
    
    .card-front {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 50%, #4338ca 100%);
        color: white;
        box-shadow: 0 16px 40px rgba(99, 102, 241, 0.35);
    }
    
    .card-front::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -30%;
        width: 300px;
        height: 300px;
        background: rgba(255,255,255,0.08);
        border-radius: 50%;
        pointer-events: none;
    }
    
    .card-front::after {
        content: '';
        position: absolute;
        bottom: -40%;
        left: -20%;
        width: 250px;
        height: 250px;
        background: rgba(255,255,255,0.05);
        border-radius: 50%;
        pointer-events: none;
    }
    
    .card-back {
        transform: rotateY(180deg);
        background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        color: white;
        box-shadow: 0 16px 40px rgba(0, 0, 0, 0.3);
    }
    
    .card-chip {
        width: 45px;
        height: 34px;
        background: linear-gradient(135deg, #ffd700, #ffed4e);
        border-radius: 6px;
        position: relative;
        overflow: hidden;
    }
    
    .card-chip::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        right: 0;
        bottom: 0;
        width: 200%;
        background: linear-gradient(90deg, transparent 30%, rgba(255,255,255,0.4) 50%, transparent 70%);
        animation: shine 3s infinite;
    }
    
    @keyframes shine {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }
    
    .card-number {
        font-size: 22px;
        letter-spacing: 3px;
        font-family: 'Courier New', monospace;
        font-weight: 600;
        position: relative;
        z-index: 1;
    }
    
    .card-info {
        display: flex;
        justify-content: space-between;
        font-size: 13px;
        opacity: 0.9;
        position: relative;
        z-index: 1;
    }
    
    .card-info small {
        display: block;
        font-size: 10px;
        opacity: 0.7;
        margin-bottom: 4px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .card-holder {
        text-transform: uppercase;
        font-weight: 600;
        font-size: 14px;
        letter-spacing: 1px;
    }
    
    .magnetic-stripe {
        height: 45px;
        background: #000;
        width: calc(100% + 48px);
        margin: 15px -24px;
        border-radius: 0;
    }
    
    .cvv-section {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        gap: 10px;
    }
    
    .cvv-label {
        font-size: 12px;
        opacity: 0.7;
    }
    
    .cvv {
        background: white;
        color: #000;
        padding: 8px 16px;
        border-radius: 6px;
        font-family: 'Courier New', monospace;
        font-weight: 700;
        font-size: 16px;
        letter-spacing: 2px;
    }
    
    .card-back-info {
        font-size: 11px;
        opacity: 0.5;
        text-align: center;
        line-height: 1.4;
    }
    
    /* –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è */
    .quick-actions {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 12px;
    }
    
    .action-btn {
        background: var(--light);
        border: 1px solid var(--border);
        padding: 16px 8px;
        border-radius: var(--radius-sm);
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        color: var(--dark);
        position: relative;
        overflow: hidden;
        font-family: 'Inter', sans-serif;
    }
    
    .action-btn i { 
        font-size: 22px; 
        color: var(--primary);
        transition: var(--transition);
    }
    
    .action-btn:active {
        transform: scale(0.93);
        background: var(--primary);
        color: white;
        border-color: var(--primary);
    }
    
    .action-btn:active i {
        color: white;
    }
    
    /* –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ */
    .transactions-list {
        position: relative;
    }
    
    .transaction-item {
        background: var(--light);
        border-radius: var(--radius-sm);
        padding: 16px;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        transition: var(--transition);
        position: relative;
        overflow: hidden;
        cursor: pointer;
        user-select: none;
        border: 1px solid var(--border);
    }
    
    .transaction-item:last-child {
        margin-bottom: 0;
    }
    
    .transaction-item:active {
        transform: scale(0.98);
    }
    
    .transaction-content {
        display: flex;
        align-items: center;
        flex: 1;
        min-width: 0;
    }
    
    .transaction-icon {
        width: 46px;
        height: 46px;
        border-radius: 13px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
        color: white;
        margin-right: 14px;
        flex-shrink: 0;
    }
    
    .transaction-info {
        flex: 1;
        min-width: 0;
    }
    
    .transaction-title {
        font-weight: 600;
        font-size: 15px;
        margin-bottom: 3px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        color: var(--dark);
    }
    
    .transaction-date {
        font-size: 12px;
        color: var(--gray);
    }
    
    .transaction-amount {
        font-weight: 700;
        font-size: 16px;
        text-align: right;
        flex-shrink: 0;
        margin-left: 12px;
        white-space: nowrap;
    }
    
    .transaction-amount.income {
        color: var(--success);
    }
    
    .transaction-amount.expense {
        color: var(--dark);
    }
    
    /* –ö—É—Ä—Å—ã –≤–∞–ª—é—Ç */
    .currency-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
    }
    
    .currency-card {
        background: var(--light);
        border-radius: var(--radius-sm);
        padding: 16px;
        border: 1px solid var(--border);
        transition: var(--transition);
        cursor: pointer;
    }
    
    .currency-card:active {
        transform: scale(0.97);
    }
    
    .currency-top {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 10px;
    }
    
    .currency-flag {
        font-size: 28px;
        line-height: 1;
    }
    
    .currency-code {
        font-weight: 700;
        font-size: 15px;
        color: var(--dark);
    }
    
    .currency-name {
        font-size: 12px;
        color: var(--gray);
    }
    
    .currency-bottom {
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
    }
    
    .currency-rate {
        font-size: 20px;
        font-weight: 800;
        color: var(--dark);
        line-height: 1;
    }
    
    .currency-unit {
        font-size: 13px;
        color: var(--gray);
        font-weight: 500;
    }
    
    .currency-change {
        font-size: 13px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 4px;
        padding: 4px 8px;
        border-radius: 8px;
    }
    
    .change-up { 
        color: var(--success); 
        background: rgba(16, 185, 129, 0.1);
    }
    .change-down { 
        color: var(--danger); 
        background: rgba(239, 68, 68, 0.1);
    }
    
    /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ */
    .categories-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
    }
    
    .category-item {
        background: var(--light);
        border-radius: var(--radius-sm);
        padding: 18px 12px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        text-align: center;
        border: 1px solid var(--border);
        transition: var(--transition);
        cursor: pointer;
    }
    
    .category-item:active {
        transform: scale(0.95);
    }
    
    .category-icon {
        width: 46px;
        height: 46px;
        border-radius: 13px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: white;
    }
    
    .category-name {
        font-weight: 600;
        font-size: 13px;
        color: var(--dark);
        line-height: 1.3;
    }
    
    .category-amount {
        font-weight: 700;
        font-size: 14px;
        color: var(--primary);
    }
    
    /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
    .stats-hero {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 20px;
    }
    
    .stats-total {
        font-size: 28px;
        font-weight: 800;
        color: var(--dark);
        line-height: 1.2;
    }
    
    .stats-label {
        font-size: 13px;
        color: var(--gray);
        margin-top: 4px;
    }
    
    .stats-change {
        font-size: 16px;
        font-weight: 700;
        color: var(--success);
        text-align: right;
    }
    
    .stats-change-label {
        font-size: 12px;
        color: var(--gray);
        text-align: right;
        margin-top: 4px;
    }
    
    .progress-bar {
        background: var(--light);
        height: 12px;
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 10px;
    }
    
    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--primary), var(--primary-light));
        border-radius: 6px;
        transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .progress-labels {
        display: flex;
        justify-content: space-between;
        font-size: 12px;
        color: var(--gray);
    }
    
    /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é */
    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: var(--card);
        border-top: 1px solid var(--border);
        padding: 8px 12px;
        display: flex;
        justify-content: space-around;
        align-items: center;
        z-index: 100;
        box-shadow: 0 -4px 20px rgba(0,0,0,0.06);
    }
    
    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        color: var(--gray);
        text-decoration: none;
        padding: 8px 12px;
        border-radius: 12px;
        transition: var(--transition);
        font-size: 11px;
        font-weight: 600;
        min-width: 60px;
        position: relative;
        gap: 4px;
    }
    
    .nav-item i {
        font-size: 20px;
        transition: var(--transition);
    }
    
    .nav-item.active {
        color: var(--primary);
    }
    
    .nav-item.active::before {
        content: '';
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 20px;
        height: 3px;
        background: var(--primary);
        border-radius: 0 0 3px 3px;
    }
    
    .nav-item:active {
        transform: scale(0.9);
    }
    
    .nav-pulse {
        position: absolute;
        top: 6px;
        right: 10px;
        width: 7px;
        height: 7px;
        background: var(--danger);
        border-radius: 50%;
        border: 1.5px solid var(--card);
    }
    
    /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.5);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        align-items: flex-end;
        justify-content: center;
        z-index: 1000;
        padding: 0;
    }
    
    .modal-overlay.active { 
        display: flex; 
    }
    
    .modal-content {
        background: var(--card);
        border-radius: 24px 24px 0 0;
        width: 100%;
        max-width: 600px;
        max-height: 90vh;
        overflow-y: auto;
        animation: modalSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        color: var(--dark);
    }
    
    @keyframes modalSlideUp {
        from { transform: translateY(100%); }
        to { transform: translateY(0); }
    }
    
    .modal-handle {
        width: 40px;
        height: 4px;
        background: var(--gray-light);
        border-radius: 2px;
        margin: 12px auto 0;
    }
    
    .modal-header {
        padding: 20px 24px 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .modal-header h2 {
        font-size: 22px;
        font-weight: 700;
    }
    
    .modal-close {
        width: 38px;
        height: 38px;
        border-radius: 10px;
        background: var(--light);
        border: 1px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--dark);
        font-size: 16px;
        cursor: pointer;
        transition: var(--transition);
    }
    
    .modal-close:active {
        transform: scale(0.9);
    }
    
    .modal-body {
        padding: 12px 24px 34px;
    }
    
    .input-group {
        margin-bottom: 18px;
    }
    
    .input-label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--dark);
        font-size: 14px;
    }
    
    input, select, textarea {
        width: 100%;
        padding: 16px 18px;
        border-radius: 12px;
        border: 2px solid var(--border);
        background: var(--light);
        color: var(--dark);
        font-size: 16px;
        font-family: 'Inter', sans-serif;
        transition: var(--transition);
        appearance: none;
        -webkit-appearance: none;
    }
    
    select {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 16px center;
        padding-right: 40px;
    }
    
    textarea {
        resize: vertical;
        min-height: 80px;
    }
    
    input:focus, select:focus, textarea:focus {
        outline: none;
        border-color: var(--primary);
        background: var(--card);
        box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
    }
    
    .input-with-icon {
        position: relative;
    }
    
    .input-with-icon input {
        padding-right: 50px;
    }
    
    .input-icon {
        position: absolute;
        right: 18px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray);
        font-size: 18px;
        pointer-events: none;
    }
    
    .btn {
        padding: 16px 24px;
        border-radius: 14px;
        border: none;
        font-size: 16px;
        font-weight: 700;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        width: 100%;
        font-family: 'Inter', sans-serif;
    }
    
    .btn-primary {
        background: var(--primary);
        color: white;
        box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
    }
    
    .btn-primary:active {
        transform: translateY(2px);
        box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3);
    }
    
    /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ-—Ç–æ—Å—Ç */
    .notification-toast {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%) translateY(-120px);
        background: var(--card);
        color: var(--dark);
        padding: 16px 20px;
        border-radius: 16px;
        box-shadow: 0 16px 40px rgba(0,0,0,0.15);
        z-index: 1100;
        display: flex;
        align-items: center;
        gap: 14px;
        max-width: calc(100% - 40px);
        width: auto;
        transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        border: 1px solid var(--border);
    }
    
    .notification-toast.show {
        transform: translateX(-50%) translateY(0);
    }
    
    .toast-icon {
        width: 38px;
        height: 38px;
        border-radius: 10px;
        background: var(--primary);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        flex-shrink: 0;
    }
    
    .toast-content {
        flex: 1;
        min-width: 0;
    }
    
    .toast-title {
        font-weight: 700;
        font-size: 15px;
    }
    
    .toast-message {
        font-size: 13px;
        color: var(--gray);
        margin-top: 2px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    /* –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é */
    .context-menu {
        position: fixed;
        background: var(--card);
        border-radius: 16px;
        box-shadow: 0 16px 40px rgba(0,0,0,0.2);
        z-index: 1050;
        padding: 8px;
        min-width: 220px;
        display: none;
        border: 1px solid var(--border);
    }
    
    .context-menu.active {
        display: block;
        animation: contextIn 0.2s ease;
    }
    
    @keyframes contextIn {
        from { opacity: 0; transform: scale(0.95); }
        to { opacity: 1; transform: scale(1); }
    }
    
    .context-item {
        padding: 12px 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        cursor: pointer;
        transition: var(--transition);
        color: var(--dark);
        font-weight: 500;
        font-size: 14px;
        border-radius: 10px;
    }
    
    .context-item:active {
        background: var(--light);
    }
    
    .context-item i {
        width: 20px;
        text-align: center;
        color: var(--primary);
        font-size: 16px;
    }
    
    /* –ì–æ–ª–æ—Å–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä */
    .voice-indicator {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        width: 160px;
        height: 160px;
        background: var(--primary);
        border-radius: 50%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 1100;
        color: white;
        font-size: 40px;
        box-shadow: 0 20px 60px rgba(99, 102, 241, 0.5);
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        gap: 10px;
    }
    
    .voice-indicator span {
        font-size: 12px;
        font-weight: 600;
        letter-spacing: 1px;
        text-transform: uppercase;
    }
    
    .voice-indicator.active {
        transform: translate(-50%, -50%) scale(1);
        animation: pulseVoice 1.5s infinite;
    }
    
    @keyframes pulseVoice {
        0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7); }
        70% { box-shadow: 0 0 0 30px rgba(99, 102, 241, 0); }
        100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
    }
    
    /* PWA Install */
    .install-banner {
        display: none;
        position: fixed;
        bottom: 80px;
        left: 16px;
        right: 16px;
        max-width: 568px;
        margin: 0 auto;
        background: var(--card);
        border-radius: var(--radius);
        padding: 20px;
        box-shadow: var(--shadow-lg);
        border: 1px solid var(--border);
        z-index: 90;
        animation: modalSlideUp 0.4s ease;
    }
    
    .install-banner.active {
        display: block;
    }
    
    .install-text {
        font-size: 14px;
        color: var(--gray);
        margin-bottom: 16px;
        line-height: 1.5;
    }
    
    .install-actions {
        display: flex;
        gap: 10px;
    }
    
    .install-actions .btn {
        flex: 1;
        padding: 12px;
        font-size: 14px;
    }
    
    .btn-ghost {
        background: var(--light);
        color: var(--dark);
        border: 1px solid var(--border);
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (max-width: 380px) {
        .container { padding: 12px; padding-bottom: 90px; }
        .quick-actions { gap: 8px; }
        .action-btn { padding: 14px 6px; font-size: 11px; }
        .action-btn i { font-size: 20px; }
        .currency-grid { grid-template-columns: 1fr; }
        .categories-grid { grid-template-columns: repeat(2, 1fr); }
        .balance-amount { font-size: 30px; }
        .bank-card-container { height: 190px; }
        .card-number { font-size: 18px; }
    }
    
    @media (min-width: 768px) {
        .container { max-width: 700px; padding: 24px; padding-bottom: 30px; }
        .bottom-nav { display: none; }
    }
    
    /* iOS safe area */
    @supports (padding-bottom: env(safe-area-inset-bottom)) {
        .container {
            padding-bottom: calc(100px + env(safe-area-inset-bottom));
        }
        .bottom-nav {
            padding-bottom: calc(8px + env(safe-area-inset-bottom));
        }
    }
    
    /* –°–∫—Ä–æ–ª–ª-–±–∞—Ä */
    ::-webkit-scrollbar { width: 0; height: 0; }
    
    /* –£–±–∏—Ä–∞–µ–º outline –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
    @media (hover: none) {
        *:focus { outline: none; }
    }
</style>
</head>
<body data-theme="light">
    <!-- Pull-to-refresh -->
    <div class="refresh-indicator" id="refreshIndicator">
        <i class="fas fa-sync-alt"></i>
        <span>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...</span>
    </div>

    <!-- –ì–æ–ª–æ—Å–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä -->
    <div class="voice-indicator" id="voiceIndicator">
        <i class="fas fa-microphone"></i>
        <span>–ì–æ–≤–æ—Ä–∏—Ç–µ...</span>
    </div>

    <div class="container" id="mainContainer">
        <!-- Header -->
        <header id="mainHeader">
            <div class="header-top">
                <div class="logo" id="logo">
                    <i class="fas fa-university"></i>
                    <span>Neobank</span>
                </div>
                <div class="header-actions">
                    <button class="icon-btn" id="searchBtn" aria-label="–ü–æ–∏—Å–∫">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="icon-btn" id="notificationBtn" aria-label="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notificationBadge">3</span>
                    </button>
                    <button class="icon-btn" id="themeToggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
            
            <div class="balance-section" id="balanceSection">
                <span class="balance-label">–î–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å</span>
                <div class="balance-amount" id="balanceAmount">
                    ‚ÇΩ<span id="balanceWhole">248 732</span>.<span id="balanceDecimal">48</span>
                </div>
            </div>
        </header>

        <!-- –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞ -->
        <div class="bank-card-container">
            <div class="bank-card" id="bankCard">
                <div class="card-front">
                    <div class="card-chip"></div>
                    <div class="card-number">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 8921</div>
                    <div class="card-info">
                        <div>
                            <small>–î–µ—Ä–∂–∞—Ç–µ–ª—å –∫–∞—Ä—Ç—ã</small>
                            <div class="card-holder">–ú–ê–ò–† –°–ê–î–´–ö–û–í</div>
                        </div>
                        <div style="text-align: right;">
                            <small>–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ</small>
                            <div style="font-weight: 600;">12/35</div>
                        </div>
                    </div>
                </div>
                <div class="card-back">
                    <div class="magnetic-stripe"></div>
                    <div class="cvv-section">
                        <span class="cvv-label">CVV</span>
                        <div class="cvv">332</div>
                    </div>
                    <div class="card-back-info">
                        –î–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å<br>–≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É Neobank
                    </div>
                </div>
            </div>
        </div>

        <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
        <div class="section-card">
            <div class="section-header">
                <h3 class="section-title">–î–µ–π—Å—Ç–≤–∏—è</h3>
            </div>
            <div class="quick-actions">
                <button class="action-btn" onclick="openTransferModal()">
                    <i class="fas fa-exchange-alt"></i>
                    –ü–µ—Ä–µ–≤–æ–¥
                </button>
                <button class="action-btn" onclick="openPaymentModal()">
                    <i class="fas fa-mobile-alt"></i>
                    –ü–ª–∞—Ç–µ–∂–∏
                </button>
                <button class="action-btn" onclick="showQRScanner()">
                    <i class="fas fa-qrcode"></i>
                    QR
                </button>
                <button class="action-btn" onclick="startVoiceCommand()">
                    <i class="fas fa-microphone"></i>
                    –ì–æ–ª–æ—Å
                </button>
                <button class="action-btn" onclick="openDepositModal()">
                    <i class="fas fa-piggy-bank"></i>
                    –í–∫–ª–∞–¥
                </button>
                <button class="action-btn" onclick="showAtms()">
                    <i class="fas fa-map-marker-alt"></i>
                    –ë–∞–Ω–∫–æ–º–∞—Ç—ã
                </button>
                <button class="action-btn" onclick="showCategories()">
                    <i class="fas fa-chart-pie"></i>
                    –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
                </button>
                <button class="action-btn" onclick="toggleTheme()">
                    <i class="fas fa-palette"></i>
                    –¢–µ–º–∞
                </button>
            </div>
        </div>

        <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
        <div class="section-card">
            <div class="section-header">
                <h3 class="section-title">–û–ø–µ—Ä–∞—Ü–∏–∏</h3>
                <button class="section-action" onclick="showAllTransactions()">–í—Å–µ</button>
            </div>
            <div class="transactions-list" id="transactionsList"></div>
        </div>

        <!-- –ö—É—Ä—Å—ã –≤–∞–ª—é—Ç -->
        <div class="section-card">
            <div class="section-header">
                <h3 class="section-title">–ö—É—Ä—Å—ã –≤–∞–ª—é—Ç</h3>
            </div>
            <div class="currency-grid" id="currencyGrid"></div>
        </div>

        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ -->
        <div class="section-card">
            <div class="section-header">
                <h3 class="section-title">–†–∞—Å—Ö–æ–¥—ã</h3>
            </div>
            <div class="categories-grid" id="categoriesGrid"></div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="section-card">
            <div class="section-header">
                <h3 class="section-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            </div>
            <div class="stats-hero">
                <div>
                    <div class="stats-total">‚ÇΩ248 732</div>
                    <div class="stats-label">–í—Å–µ–≥–æ —Ä–∞—Å—Ö–æ–¥–æ–≤</div>
                </div>
                <div>
                    <div class="stats-change">‚Üì 12%</div>
                    <div class="stats-change-label">–∫ –ø—Ä–æ—à–ª–æ–º—É –º–µ—Å—è—Ü—É</div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>
            <div class="progress-labels">
                <span>1 –º–∞—Ä—Ç–∞</span>
                <span>–°–µ–≥–æ–¥–Ω—è</span>
            </div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é -->
    <nav class="bottom-nav">
        <a href="#" class="nav-item active" data-nav="home">
            <i class="fas fa-home"></i>
            –ì–ª–∞–≤–Ω–∞—è
        </a>
        <a href="#" class="nav-item" data-nav="cards">
            <i class="fas fa-credit-card"></i>
            –ö–∞—Ä—Ç—ã
        </a>
        <a href="#" class="nav-item" data-nav="transfer">
            <i class="fas fa-exchange-alt"></i>
            –ü–µ—Ä–µ–≤–æ–¥
        </a>
        <a href="#" class="nav-item" data-nav="stats">
            <i class="fas fa-chart-bar"></i>
            –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
        </a>
        <a href="#" class="nav-item" data-nav="profile">
            <i class="fas fa-user"></i>
            –ü—Ä–æ—Ñ–∏–ª—å
        </a>
    </nav>

    <!-- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é -->
    <div class="context-menu" id="contextMenu">
        <div class="context-item" onclick="repeatTransaction()">
            <i class="fas fa-redo"></i> –ü–æ–≤—Ç–æ—Ä–∏—Ç—å
        </div>
        <div class="context-item" onclick="addToFavorites()">
            <i class="fas fa-star"></i> –í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
        </div>
        <div class="context-item" onclick="showDetails()">
            <i class="fas fa-info-circle"></i> –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏
        </div>
        <div class="context-item" onclick="reportTransaction()">
            <i class="fas fa-flag"></i> –ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∞ -->
    <div class="modal-overlay" id="transferModal">
        <div class="modal-content">
            <div class="modal-handle"></div>
            <div class="modal-header">
                <h2>–ù–æ–≤—ã–π –ø–µ—Ä–µ–≤–æ–¥</h2>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label class="input-label">–ö–æ–º—É –ø–µ—Ä–µ–≤–µ—Å—Ç–∏</label>
                    <div class="input-with-icon">
                        <input type="text" placeholder="–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω" id="transferTo">
                        <div class="input-icon"><i class="fas fa-user-friends"></i></div>
                    </div>
                </div>
                <div class="input-group">
                    <label class="input-label">–°—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞</label>
                    <div class="input-with-icon">
                        <input type="number" placeholder="0" id="transferAmount" inputmode="decimal">
                        <div class="input-icon"><i class="fas fa-ruble-sign"></i></div>
                    </div>
                </div>
                <div class="input-group">
                    <label class="input-label">–°–æ–æ–±—â–µ–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <textarea placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞ –æ–±–µ–¥" rows="3" id="transferMessage"></textarea>
                </div>
                <button class="btn btn-primary" onclick="makeTransfer()" style="margin-top: 8px;">
                    <i class="fas fa-paper-plane"></i>
                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã -->
    <div class="modal-overlay" id="paymentModal">
        <div class="modal-content">
            <div class="modal-handle"></div>
            <div class="modal-header">
                <h2>–û–ø–ª–∞—Ç–∞ —É—Å–ª—É–≥</h2>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label class="input-label">–¢–∏–ø —É—Å–ª—É–≥–∏</label>
                    <select id="serviceType">
                        <option value="mobile">–ú–æ–±–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å</option>
                        <option value="internet">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç</option>
                        <option value="utilities">–ñ–ö–£</option>
                        <option value="tv">–¢–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ</option>
                    </select>
                </div>
                <div class="input-group">
                    <label class="input-label">–ù–æ–º–µ—Ä —Å—á–µ—Ç–∞ / —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
                    <input type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä" id="accountNumber">
                </div>
                <div class="input-group">
                    <label class="input-label">–°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞</label>
                    <div class="input-with-icon">
                        <input type="number" placeholder="0" id="paymentAmount" inputmode="decimal">
                        <div class="input-icon"><i class="fas fa-ruble-sign"></i></div>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="makePayment()" style="margin-top: 8px;">
                    <i class="fas fa-bolt"></i>
                    –û–ø–ª–∞—Ç–∏—Ç—å
                </button>
            </div>
        </div>
    </div>

    <!-- –¢–æ—Å—Ç-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="notification-toast" id="notificationToast">
        <div class="toast-icon" id="toastIcon">
            <i class="fas fa-check"></i>
        </div>
        <div class="toast-content">
            <div class="toast-title">–£—Å–ø–µ—à–Ω–æ!</div>
            <div class="toast-message" id="toastMessage">–û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞</div>
        </div>
    </div>

    <!-- PWA Install Banner -->
    <div class="install-banner" id="installBanner">
        <div class="install-text">
            <strong>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Neobank</strong> –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏ —Ä–∞–±–æ—Ç—ã –æ—Ñ—Ñ–ª–∞–π–Ω.
        </div>
        <div class="install-actions">
            <button class="btn btn-ghost" onclick="hideInstallPrompt()">–ü–æ–∑–∂–µ</button>
            <button class="btn btn-primary" onclick="installPWA()">
                <i class="fas fa-download"></i> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
            </button>
        </div>
    </div>

<script>
// ===================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====================
let deferredPrompt = null;
let currentTheme = localStorage.getItem('theme') || 'light';
let balanceHidden = localStorage.getItem('balanceHidden') === 'true';
let lastScrollTop = 0;
let refreshStartY = 0;
let isRefreshing = false;
let voiceRecognition = null;
let toastTimeout = null;

// ===================== –î–ê–ù–ù–´–ï =====================
const transactions = [
    { id: 3, title: "Steam Store", date: "–í—á–µ—Ä–∞, 23:11", amount: -6990, icon: "fa-gamepad", color: "#f59e0b" },
    { id: 4, title: "–ü–µ—Ä–µ–≤–æ–¥ –æ—Ç –ò—Å–ª–∞–º. –ö", date: "12 –º–∞—Ä—Ç–∞, 14:20", amount: 50000, icon: "fa-user-plus", color: "#10b981" },
];

const currencies = [
    { code: "USD", name: "–î–æ–ª–ª–∞—Ä", rate: 96.42, change: 0.31, symbol: "üá∫üá∏" },
    { code: "EUR", name: "–ï–≤—Ä–æ", rate: 103.87, change: -0.12, symbol: "üá™üá∫" },
    { code: "CNY", name: "–Æ–∞–Ω—å", rate: 13.41, change: 0.08, symbol: "üá®üá≥" },
    { code: "GBP", name: "–§—É–Ω—Ç", rate: 122.15, change: 0.45, symbol: "üá¨üáß" }
];

const categories = [
    { name: "–ü—Ä–æ–¥—É–∫—Ç—ã", amount: 15420, icon: "fa-shopping-basket", color: "#10b981" },
    { name: "–ö–∞—Ñ–µ", amount: 8320, icon: "fa-coffee", color: "#f59e0b" },
    { name: "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", amount: 4560, icon: "fa-bus", color: "#3b82f6" },
    { name: "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è", amount: 12500, icon: "fa-film", color: "#8b5cf6" },
    { name: "–®–æ–ø–∏–Ω–≥", amount: 28400, icon: "fa-shopping-bag", color: "#ef4444" },
    { name: "–ó–¥–æ—Ä–æ–≤—å–µ", amount: 7600, icon: "fa-heart", color: "#ec4899" }
];

// ===================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====================
document.addEventListener('DOMContentLoaded', function() {
    setTheme(currentTheme);
    initBalance();
    loadTransactions();
    loadCurrencies();
    loadCategories();
    setupGestures();
    setupScrollAnimations();
    setupVoiceRecognition();
    setupNavigation();
    animateCounters();
    initPWA();
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
    setTimeout(() => {
        document.getElementById('progressFill').style.width = '65%';
    }, 500);
    
    // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
    setTimeout(() => {
        showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Neobank!', 'fas fa-university');
    }, 800);
});

// ===================== –¢–ï–ú–ê =====================
function setTheme(theme) {
    document.body.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
    currentTheme = theme;
    
    const icon = document.getElementById('themeToggle').querySelector('i');
    icon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
    
    document.querySelector('meta[name="theme-color"]').setAttribute(
        'content', theme === 'dark' ? '#0f172a' : '#6366f1'
    );
}

function toggleTheme() {
    setTheme(currentTheme === 'light' ? 'dark' : 'light');
    showNotification('–¢–µ–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∞', 'fas fa-palette');
}

document.getElementById('themeToggle').addEventListener('click', toggleTheme);

// ===================== –ë–ê–õ–ê–ù–° =====================
function initBalance() {
    const balanceAmount = document.getElementById('balanceAmount');
    if (balanceHidden) balanceAmount.classList.add('balance-hidden');
    
    let tapCount = 0;
    let tapTimer;
    
    document.getElementById('balanceSection').addEventListener('click', function() {
        tapCount++;
        clearTimeout(tapTimer);
        
        if (tapCount === 2) {
            balanceHidden = !balanceHidden;
            balanceAmount.classList.toggle('balance-hidden');
            localStorage.setItem('balanceHidden', balanceHidden);
            showNotification(
                balanceHidden ? '–ë–∞–ª–∞–Ω—Å —Å–∫—Ä—ã—Ç' : '–ë–∞–ª–∞–Ω—Å –ø–æ–∫–∞–∑–∞–Ω',
                balanceHidden ? 'fas fa-eye-slash' : 'fas fa-eye'
            );
            tapCount = 0;
        } else {
            tapTimer = setTimeout(() => { tapCount = 0; }, 400);
        }
    });
}

// ===================== –ê–ù–ò–ú–ê–¶–ò–Ø –°–ß–Å–¢–ß–ò–ö–û–í =====================
function animateCounters() {
    const animateValue = (el, end, duration) => {
        let start = 0;
        let startTime = null;
        
        const step = (time) => {
            if (!startTime) startTime = time;
            const progress = Math.min((time - startTime) / duration, 1);
            const eased = 1 - Math.pow(1 - progress, 3); // easeOutCubic
            const value = Math.floor(eased * end);
            el.textContent = value.toLocaleString('ru-RU');
            if (progress < 1) requestAnimationFrame(step);
        };
        
        requestAnimationFrame(step);
    };
    
    animateValue(document.getElementById('balanceWhole'), 1248732, 1800);
    animateValue(document.getElementById('balanceDecimal'), 48, 1800);
}

// ===================== –¢–†–ê–ù–ó–ê–ö–¶–ò–ò =====================
function loadTransactions() {
    const container = document.getElementById('transactionsList');
    container.innerHTML = '';
    
    transactions.forEach(t => {
        const el = document.createElement('div');
        el.className = 'transaction-item';
        el.dataset.id = t.id;
        
        const isIncome = t.amount > 0;
        const sign = isIncome ? '+' : '‚àí';
        const amountClass = isIncome ? 'income' : 'expense';
        
        el.innerHTML = `
            <div class="transaction-content">
                <div class="transaction-icon" style="background: ${t.color};">
                    <i class="fas ${t.icon}"></i>
                </div>
                <div class="transaction-info">
                    <div class="transaction-title">${t.title}</div>
                    <div class="transaction-date">${t.date}</div>
                </div>
            </div>
            <div class="transaction-amount ${amountClass}">
                ${sign}${Math.abs(t.amount).toLocaleString('ru-RU')} ‚ÇΩ
            </div>
        `;
        
        // –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
        let pressTimer;
        
        el.addEventListener('touchstart', (e) => {
            pressTimer = setTimeout(() => {
                showContextMenu(e, t);
            }, 500);
        }, { passive: true });
        
        el.addEventListener('touchend', () => clearTimeout(pressTimer));
        el.addEventListener('touchmove', () => clearTimeout(pressTimer));
        
        el.addEventListener('click', () => {
            showNotification(`${t.title}: ${sign}${Math.abs(t.amount).toLocaleString('ru-RU')} ‚ÇΩ`, `fas ${t.icon}`);
        });
        
        container.appendChild(el);
    });
}

// ===================== –ö–û–ù–¢–ï–ö–°–¢–ù–û–ï –ú–ï–ù–Æ =====================
function showContextMenu(e, transaction) {
    const menu = document.getElementById('contextMenu');
    
    let x, y;
    if (e.touches) {
        x = e.touches[0].clientX;
        y = e.touches[0].clientY;
    } else {
        x = e.clientX;
        y = e.clientY;
    }
    
    // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –º–µ–Ω—é –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —ç–∫—Ä–∞–Ω
    const menuWidth = 220;
    const menuHeight = 200;
    
    if (x + menuWidth > window.innerWidth) x = window.innerWidth - menuWidth - 16;
    if (y + menuHeight > window.innerHeight) y = window.innerHeight - menuHeight - 16;
    if (x < 16) x = 16;
    if (y < 16) y = 16;
    
    menu.style.top = y + 'px';
    menu.style.left = x + 'px';
    menu.classList.add('active');
    
    const closeMenu = (ev) => {
        if (!menu.contains(ev.target)) {
            menu.classList.remove('active');
            document.removeEventListener('click', closeMenu);
            document.removeEventListener('touchstart', closeMenu);
        }
    };
    
    setTimeout(() => {
        document.addEventListener('click', closeMenu);
        document.addEventListener('touchstart', closeMenu);
    }, 50);
}

function repeatTransaction() { showNotification('–û–ø–µ—Ä–∞—Ü–∏—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∞', 'fas fa-redo'); closeContextMenu(); }
function addToFavorites() { showNotification('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ', 'fas fa-star'); closeContextMenu(); }
function reportTransaction() { showNotification('–ñ–∞–ª–æ–±–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞', 'fas fa-flag'); closeContextMenu(); }
function showDetails() { showNotification('–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏', 'fas fa-info-circle'); closeContextMenu(); }
function closeContextMenu() { document.getElementById('contextMenu').classList.remove('active'); }

// ===================== –í–ê–õ–Æ–¢–´ =====================
function loadCurrencies() {
    const container = document.getElementById('currencyGrid');
    container.innerHTML = '';
    
    currencies.forEach(c => {
        const el = document.createElement('div');
        el.className = 'currency-card';
        
        const changeClass = c.change >= 0 ? 'change-up' : 'change-down';
        const changeIcon = c.change >= 0 ? 'fa-arrow-up' : 'fa-arrow-down';
        
        el.innerHTML = `
            <div class="currency-top">
                <div class="currency-flag">${c.symbol}</div>
                <div>
                    <div class="currency-code">${c.code}</div>
                    <div class="currency-name">${c.name}</div>
                </div>
            </div>
            <div class="currency-bottom">
                <div>
                    <div class="currency-rate">${c.rate.toFixed(2)}</div>
                    <div class="currency-unit">‚ÇΩ</div>
                </div>
                <div class="currency-change ${changeClass}">
                    <i class="fas ${changeIcon}" style="font-size: 10px;"></i>
                    ${Math.abs(c.change)}%
                </div>
            </div>
        `;
        
        el.addEventListener('click', () => {
            showNotification(`${c.code}: ${c.rate.toFixed(2)} ‚ÇΩ`, 'fas fa-chart-line');
        });
        
        container.appendChild(el);
    });
}

// ===================== –ö–ê–¢–ï–ì–û–†–ò–ò =====================
function loadCategories() {
    const container = document.getElementById('categoriesGrid');
    container.innerHTML = '';
    
    categories.forEach(cat => {
        const el = document.createElement('div');
        el.className = 'category-item';
        
        el.innerHTML = `
            <div class="category-icon" style="background: ${cat.color};">
                <i class="fas ${cat.icon}"></i>
            </div>
            <div class="category-name">${cat.name}</div>
            <div class="category-amount">${cat.amount.toLocaleString('ru-RU')} ‚ÇΩ</div>
        `;
        
        el.addEventListener('click', () => {
            showNotification(`${cat.name}: ${cat.amount.toLocaleString('ru-RU')} ‚ÇΩ`, `fas ${cat.icon}`);
        });
        
        container.appendChild(el);
    });
}

// ===================== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê =====================
function openTransferModal() { document.getElementById('transferModal').classList.add('active'); }
function openPaymentModal() { document.getElementById('paymentModal').classList.add('active'); }

function closeModal() {
    document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active'));
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –Ω–∞ overlay
document.querySelectorAll('.modal-overlay').forEach(overlay => {
    overlay.addEventListener('click', function(e) {
        if (e.target === this) closeModal();
    });
});

function makeTransfer() {
    const amount = document.getElementById('transferAmount').value;
    const to = document.getElementById('transferTo').value;
    
    if (!amount || !to) {
        showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'fas fa-exclamation-triangle');
        return;
    }
    
    showNotification(`–ü–µ—Ä–µ–≤–æ–¥ ${parseInt(amount).toLocaleString('ru-RU')} ‚ÇΩ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω`, 'fas fa-check-circle');
    closeModal();
    document.getElementById('transferAmount').value = '';
    document.getElementById('transferTo').value = '';
    document.getElementById('transferMessage').value = '';
}

function makePayment() {
    const amount = document.getElementById('paymentAmount').value;
    
    if (!amount) {
        showNotification('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ø–ª–∞—Ç–µ–∂–∞', 'fas fa-exclamation-triangle');
        return;
    }
    
    showNotification(`–û–ø–ª–∞—Ç–∞ ${parseInt(amount).toLocaleString('ru-RU')} ‚ÇΩ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞`, 'fas fa-bolt');
    closeModal();
    document.getElementById('paymentAmount').value = '';
}

// ===================== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====================
function showNotification(message, icon = 'fas fa-info-circle', duration = 3000) {
    const toast = document.getElementById('notificationToast');
    const msgEl = document.getElementById('toastMessage');
    const iconEl = document.getElementById('toastIcon').querySelector('i');
    
    if (toastTimeout) {
        clearTimeout(toastTimeout);
        toast.classList.remove('show');
    }
    
    msgEl.textContent = message;
    iconEl.className = icon;
    
    // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Ä–µ-–∞–Ω–∏–º–∞—Ü–∏–∏
    requestAnimationFrame(() => {
        toast.classList.add('show');
    });
    
    toastTimeout = setTimeout(() => {
        toast.classList.remove('show');
        toastTimeout = null;
    }, duration);
}

// ===================== –ñ–ï–°–¢–´ =====================
function setupGestures() {
    const container = document.getElementById('mainContainer');
    const refreshIndicator = document.getElementById('refreshIndicator');
    
    container.addEventListener('touchstart', (e) => {
        if (window.scrollY <= 0) refreshStartY = e.touches[0].clientY;
    }, { passive: true });
    
    container.addEventListener('touchmove', (e) => {
        if (!isRefreshing && window.scrollY <= 0 && refreshStartY > 0) {
            const diff = e.touches[0].clientY - refreshStartY;
            if (diff > 70) {
                isRefreshing = true;
                refreshIndicator.classList.add('active');
            }
        }
    }, { passive: true });
    
    container.addEventListener('touchend', () => {
        if (isRefreshing) {
            setTimeout(refreshData, 1200);
        }
        refreshStartY = 0;
    });
}

function refreshData() {
    currencies.forEach(c => {
        const delta = (Math.random() - 0.5) * 0.5;
        c.change = parseFloat(delta.toFixed(2));
        c.rate = parseFloat((c.rate + delta).toFixed(2));
    });
    
    loadCurrencies();
    document.getElementById('refreshIndicator').classList.remove('active');
    isRefreshing = false;
    showNotification('–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'fas fa-sync-alt');
}

// ===================== SCROLL =====================
function setupScrollAnimations() {
    const header = document.getElementById('mainHeader');
    let ticking = false;
    
    window.addEventListener('scroll', () => {
        if (!ticking) {
            requestAnimationFrame(() => {
                const scrollTop = window.scrollY;
                
                if (scrollTop > 10) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
                
                if (scrollTop > lastScrollTop && scrollTop > 200) {
                    header.classList.add('hidden');
                } else {
                    header.classList.remove('hidden');
                }
                
                lastScrollTop = Math.max(0, scrollTop);
                ticking = false;
            });
            ticking = true;
        }
    }, { passive: true });
}

// ===================== –ù–ê–í–ò–ì–ê–¶–ò–Ø =====================
function setupNavigation() {
    document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', function(e) {
            e.preventDefault();
            
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            this.classList.add('active');
            
            switch(this.dataset.nav) {
                case 'home':
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                    break;
                case 'cards':
                    document.getElementById('bankCard').classList.toggle('flipped');
                    showNotification('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–∞–º–∏', 'fas fa-credit-card');
                    break;
                case 'transfer':
                    openTransferModal();
                    break;
                case 'stats':
                    document.querySelector('.section-card:last-child').scrollIntoView({ behavior: 'smooth', block: 'center' });
                    showNotification('–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤', 'fas fa-chart-bar');
                    break;
                case 'profile':
                    showNotification('–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç', 'fas fa-user');
                    break;
            }
        });
    });
}

// ===================== –ì–û–õ–û–°–û–í–û–ï –£–ü–†–ê–í–õ–ï–ù–ò–ï =====================
function setupVoiceRecognition() {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) return;
    
    voiceRecognition = new SpeechRecognition();
    voiceRecognition.continuous = false;
    voiceRecognition.interimResults = false;
    voiceRecognition.lang = 'ru-RU';
    
    voiceRecognition.onstart = () => {
        document.getElementById('voiceIndicator').classList.add('active');
    };
    
    voiceRecognition.onresult = (event) => {
        const text = event.results[0][0].transcript.toLowerCase();
        processVoiceCommand(text);
    };
    
    voiceRecognition.onend = () => {
        document.getElementById('voiceIndicator').classList.remove('active');
    };
    
    voiceRecognition.onerror = () => {
        document.getElementById('voiceIndicator').classList.remove('active');
        showNotification('–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –≥–æ–ª–æ—Å', 'fas fa-microphone-slash');
    };
}

function startVoiceCommand() {
    if (!voiceRecognition) {
        showNotification('–ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è', 'fas fa-microphone-slash');
        return;
    }
    try { voiceRecognition.start(); }
    catch(e) { showNotification('–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É', 'fas fa-microphone-slash'); }
}

function processVoiceCommand(cmd) {
    showNotification(`"${cmd}"`, 'fas fa-microphone', 2000);
    
    setTimeout(() => {
        if (cmd.includes('–ø–µ—Ä–µ–≤–æ–¥')) openTransferModal();
        else if (cmd.includes('–±–∞–ª–∞–Ω—Å')) showNotification('–ë–∞–ª–∞–Ω—Å: 1 248 732 ‚ÇΩ', 'fas fa-eye');
        else if (cmd.includes('–æ–ø–ª–∞—Ç')) openPaymentModal();
        else if (cmd.includes('—Ç–µ–º')) toggleTheme();
        else showNotification('–ö–æ–º–∞–Ω–¥–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞', 'fas fa-question-circle');
    }, 500);
}

// ===================== 3D –ö–ê–†–¢–ê =====================
document.getElementById('bankCard').addEventListener('click', function() {
    this.classList.toggle('flipped');
});

// ===================== –ü–ê–°–•–ê–õ–ö–ê =====================
let logoTaps = 0;
let logoTimer;

document.getElementById('logo').addEventListener('click', function() {
    logoTaps++;
    clearTimeout(logoTimer);
    
    if (logoTaps === 3) {
        logoTaps = 0;
        showNotification('üéâ –°–µ–∫—Ä–µ—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!', 'fas fa-magic', 4000);
        createConfetti();
    } else {
        logoTimer = setTimeout(() => { logoTaps = 0; }, 500);
    }
});

function createConfetti() {
    const colors = ['#6366f1', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#ec4899'];
    
    for (let i = 0; i < 40; i++) {
        const el = document.createElement('div');
        const size = 6 + Math.random() * 6;
        el.style.cssText = `
            position: fixed;
            width: ${size}px;
            height: ${size}px;
            background: ${colors[Math.floor(Math.random() * colors.length)]};
            border-radius: ${Math.random() > 0.5 ? '50%' : '2px'};
            top: -10px;
            left: ${Math.random() * 100}vw;
            z-index: 10000;
            pointer-events: none;
        `;
        document.body.appendChild(el);
        
        const anim = el.animate([
            { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
            { transform: `translateY(${window.innerHeight + 20}px) rotate(${Math.random() * 720}deg)`, opacity: 0 }
        ], {
            duration: 1500 + Math.random() * 2000,
            easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',
            delay: Math.random() * 300
        });
        
        anim.onfinish = () => el.remove();
    }
}

// ===================== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====================
function showQRScanner() { showNotification('–°–∫–∞–Ω–µ—Ä QR-–∫–æ–¥–æ–≤', 'fas fa-qrcode'); }
function openDepositModal() { showNotification('–û—Ç–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–∞', 'fas fa-piggy-bank'); }
function showAtms() { showNotification('–ü–æ–∏—Å–∫ –±–∞–Ω–∫–æ–º–∞—Ç–æ–≤', 'fas fa-map-marker-alt'); }
function showCategories() { showNotification('–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤', 'fas fa-chart-pie'); }
function showAllTransactions() { showNotification('–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏', 'fas fa-list'); }

// ===================== PWA =====================
function initPWA() {
    // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π manifest
    const manifest = {
        name: "Neobank",
        short_name: "Neobank",
        description: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–æ–±–∏–ª—å–Ω—ã–π –±–∞–Ω–∫–∏–Ω–≥",
        theme_color: "#6366f1",
        background_color: "#f8fafc",
        display: "standalone",
        orientation: "portrait",
        scope: "/",
        start_url: "/",
        icons: [
            { src: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='%236366f1' width='100' height='100' rx='20'/%3E%3Ctext x='50' y='65' text-anchor='middle' fill='white' font-size='50' font-family='sans-serif' font-weight='bold'%3EN%3C/text%3E%3C/svg%3E", sizes: "512x512", type: "image/svg+xml" }
        ]
    };
    
    const blob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
    const link = document.createElement('link');
    link.rel = 'manifest';
    link.href = URL.createObjectURL(blob);
    document.head.appendChild(link);
    
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        if (!localStorage.getItem('pwaInstalled')) {
            setTimeout(() => {
                document.getElementById('installBanner').classList.add('active');
            }, 15000);
        }
    });
    
    window.addEventListener('appinstalled', () => {
        localStorage.setItem('pwaInstalled', 'true');
        deferredPrompt = null;
        showNotification('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!', 'fas fa-download');
    });
}

function hideInstallPrompt() {
    document.getElementById('installBanner').classList.remove('active');
}

function installPWA() {
    if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then(() => { deferredPrompt = null; });
    }
    hideInstallPrompt();
}

// ===================== –ë–ï–ô–î–ñ –£–í–ï–î–û–ú–õ–ï–ù–ò–ô =====================
setInterval(() => {
    const badge = document.getElementById('notificationBadge');
    let count = parseInt(badge.textContent);
    if (Math.random() > 0.8 && count < 9) {
        badge.textContent = ++count;
    }
}, 30000);
</script>
</body>
</html>
